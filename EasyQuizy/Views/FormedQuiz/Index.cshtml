@model EasyQuizy.Models.ViewModels.QuizListViewModel

@{
    ViewBag.Title = "Сформировать тест";
}

<h2>Выберите необходимые тесты</h2>

<form method="get">
    <div class="form-inline">
        <label class="control-label">Предмет: </label>
        @Html.DropDownList("Subject", Model.Subjects as SelectList, htmlAttributes: new { @class = "form-control", @id = "subject"})
        <label class="control-label">Категория: </label>
        @Html.DropDownList("Category", Model.Categories as SelectList, htmlAttributes: new { @class = "form-control", @id = "category" })
        <input type="submit" value="Фильтр" class="btn btn-default" />
    </div>
</form>

    <form method="post">
    <table>
        <tr>
            <th></th>
            <th>Название теста</th>
            <th>Предмет</th>
            <th>Категория</th>
        </tr>

        @foreach (var item in Model.GeneralQuizes)
        {
            <tr>
                <td>
                    @Html.CheckBox("IsChoosen")
                    @Html.Hidden("Quizes", item.Id)
                </td>
                <td>
                    @Html.DisplayFor(m => item.Name)
                </td>
                <td>
                    @Html.DisplayFor(m => item.Subject.Name)
                </td>
                <td>
                    @Html.DisplayFor(m => item.Category.Name)
                </td>
            </tr>
        }
    </table>
        <br />
        <div class="form-inline">
            @Html.Label("FormedQuizName","Введите название формируемого теста")
            @Html.TextBox("FormedQuizName","", new { @class = "form-control" })
        </div>
        <div class="form-inline">
            @Html.Label("VariantsNumber","Количество вариантов")
            @Html.TextBox("VariantsNumber", "", new { @class = "form-control" })
            @Html.Label("QuestionsNumber", "Количество вопросов в тесте")
            @Html.TextBox("QuestionsNumber", "", new { @class = "form-control" })
        </div>
    <input type="submit" value="Сформировать" class="btn btn-success btn-md" />
</form>

@section scripts{
    <script type="text/javascript">
    $(function () {

        $('#subject').change(function()
        {
            // получаем выбранный id
            var id = $(this).val();
            $.ajax({
                type: 'GET',
                url: '@Url.Action("GetCategoriesBySubject", "GeneralQuiz")/' + id,
                success: function (data) {

                    // заменяем содержимое присланным частичным представлением
                    $('#category').replaceWith(data);
                }
            });
        });
    })
    </script>
}